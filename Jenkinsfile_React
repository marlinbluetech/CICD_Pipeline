@Library('Jenkins-SharedLibrary') _

pipeline {
    agent {label 'reactDev'}
  
    environment{
        appName = 'mbgheri'
        userEmail = 'ranjit.swain@marlinbluetech.com'
        userName = 'Ranjit Swain'
        branch = 'master'
        repoURL = 'https://github.com/marlinbluetech/mbgheri.git'

        //Deploy
        userid = 'root'
        environ = 'dev'
        server = 'test.marlinbluetech.com'
        deployPath = '/var/www/test.marlinbluetech.com/html/'

       // This can be nexus3 or nexus2
        NEXUS_VERSION = "nexus3"
        // This can be http or https
        NEXUS_PROTOCOL = "http"
        // Where your Nexus is running
        NEXUS_URL = "3.110.212.151:8081"
        // Repository where we will upload the artifact
        NEXUS_REPOSITORY = "mbgheri"
        // Jenkins credential id to authenticate to Nexus OSS
        NEXUS_CREDENTIAL_ID = "nexusCredential"
        ARTIFACT_VERSION = "${BUILD_NUMBER}"
    }

    stages{
        stage('Push To GitHub Repo'){
            steps{
                script{
                    gitCheckout.push2Remote()
                }
            }
        }
        stage('Build React App'){
            steps{
                script{
                    build.react()
                }
            }
        }
        stage('Upload To Nexus'){
            steps{
                script{
                    nexusUpload()
                }
            }
        }
        stage('Deploy'){
          // Execute the Ansible playbook
            steps{
                script{
                    bat '''
                      echo "Execute Ansible"
                    '''
                }
            }
        }
    }
}
